Looking at your current flow, I can see significant opportunities to enhance both editorial and non-editorial playlist fetching using the Spotify API (OAuth). Here's my analysis:

Current Flow Issues
Editorial Playlists:

Currently forced to use scraping (network capture → DOM fallback)
Scraping is slow (~2-3 seconds per scroll iteration)
Prone to failures if Spotify changes their HTML structure
No ISRC data from scraping (requires subsequent API calls)
Non-Editorial Playlists:

Uses Spotify API for track list ✅
Gets ISRC, label, album art immediately ✅
Much faster and more reliable ✅
Enhancement Opportunities Using Spotify API
1. Metadata Enrichment During Initial Fetch
Right now, when you fetch non-editorial playlists via API, you get:

Track name, artist, album
ISRC (critical for downstream enrichment)
Label
Album art
But the API provides much more that you're not capturing:

// Available from Spotify API but not currently stored:
- popularity (0-100 score)
- explicit (boolean)
- preview_url (30-second audio preview)
- duration_ms
- release_date
- album_type (single/album/compilation)
- available_markets (geo-restrictions)
- track_number, disc_number
Audio Features (requires separate API call but valuable):

- energy (0-1)
- danceability (0-1) 
- valence (happiness, 0-1)
- tempo (BPM)
- acousticness (0-1)
- instrumentalness (0-1)
- liveness (0-1)
- speechiness (0-1)
Artist Metadata (you're partially using this in searchTrackByNameAndArtist but not in playlist fetch):

- artist_popularity
- artist_genres (e.g., ["indie pop", "bedroom pop"])
- artist_followers
2. Editorial Playlist Partial API Enhancement
Even though editorial playlists return 404 for full access, you can still use the API for individual tracks:

Current Flow:

Scrape editorial playlist → get track URLs
Store with isrc: null
Later enrichment tries to recover ISRC via searchTrackByNameAndArtist
Enhanced Flow:

Scrape editorial playlist → get track URLs/IDs
Immediately batch-fetch track details via spotify.tracks.get() for each track ID
Get ISRC, label, popularity, audio features in one pass
Store enriched data upfront
Code Location: server/routes.ts around line 950-1050 (scraping fallback section)

3. Speed Improvements
Current Scraping:

Network capture: ~30-60 seconds for 100 tracks
DOM fallback: ~2-3 minutes for 100 tracks
With API Enhancement:

Scrape track list: 30 seconds (unchanged)
Batch API enrichment: ~5-10 seconds for 100 tracks (Spotify allows 50 tracks per request)
Total: 35-40 seconds vs 30-180 seconds
4. Data Quality Improvements
Current Issues:

~40% of scraped tracks missing ISRC
No popularity/genre data
No audio features (mood indicators)
Requires multiple enrichment passes
With API Enhancement:

100% ISRC recovery rate (if track exists in API)
Immediate popularity/genre data
Optional audio features for advanced filtering
Single enrichment pass
5. Proposed Architecture Changes
// New utility function in server/spotify.ts
async function batchEnrichTracks(trackIds: string[]): Promise<EnrichedTrack[]> {
  const spotify = await getUncachableSpotifyClient();
  const enrichedTracks = [];
  
  // Spotify allows 50 tracks per request
  for (let i = 0; i < trackIds.length; i += 50) {
    const batch = trackIds.slice(i, i + 50);
    const tracks = await spotify.tracks.get(batch);
    
    for (const track of tracks) {
      enrichedTracks.push({
        isrc: track.external_ids?.isrc || null,
        label: track.album?.label || null,
        popularity: track.popularity,
        albumArt: track.album?.images?.[1]?.url || null,
        releaseDate: track.album?.release_date,
        durationMs: track.duration_ms,
        explicit: track.explicit,
        // Optional: audio features (requires separate call)
      });
    }
  }
  
  return enrichedTracks;
}
6. Chartmetric Integration Benefit
With immediate ISRC recovery, your Chartmetric prefetch (lines 1110-1170 in routes.ts) becomes much more effective:

Current:

Scraping provides ~60% ISRCs
Chartmetric prefetch only works on those 60%
Remaining 40% fail with "skipped" status
Enhanced:

API enrichment provides ~95%+ ISRCs
Chartmetric prefetch works on 95%+ tracks
Only 5% fail (truly unavailable tracks)
Recommended Implementation Plan
Phase 1: Non-Editorial Enhancement (Low Risk)
Expand fetchAllPlaylistTracks to capture all available metadata
Add optional audio features fetch (behind feature flag)
Store popularity, genres, release dates
Phase 2: Editorial Post-Scrape Enrichment (Medium Risk)
After scraping captures track IDs, batch-fetch via API
Merge scraped data + API data
Dramatically improve ISRC recovery rate
Phase 3: Advanced Features (High Value)
Use audio features for "mood-based" filtering
Use popularity for "trending" indicators
Use genres for A&R targeting
Key Files to Modify
server/spotify.ts - Add batch enrichment utilities
server/routes.ts - Lines 950-1050 (scraping flow), lines 800-900 (API flow)
shared/schema.ts - Add new fields (popularity, audioFeatures, etc.)
server/storage.ts - Update insertTracks to handle new fields
Would you like me to implement any of these enhancements? I recommend starting with Phase 2 (editorial post-scrape enrichment) as it provides the biggest immediate win with minimal risk.